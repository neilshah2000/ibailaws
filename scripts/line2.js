window.addEventListener('load', function(){
    getcsv();
})

var lawDates;

function promiseCSV(url){
    return new Promise(function(onsuccess, onerror){
        d3.csv(url, onsuccess)
    })
}

function getcsv(){
    promiseCSV('/public/F_O_C_Master_compilation.csv').then(function(data){
        lawDates = data
        console.log(lawDates)
        buildTimeLine();
        buildVenn();
    })
}



function buildTimeLine() {
    // lawDates = ["1885-2015", "1927-1947", "1940-1988", "1941-1995", "1941-1954", "1944-1952", "1944-1947", "1945-1978", "1946-2015", "1946-2014", "1947-2015", "1947-2015", "1947-1984", "1985-2002", "1952-1954", "1953-1970", "1963-1984", "1954-1963", "1954-1978", "1954-1963", "1954-1968", "1954-2015", "1955-1968", "1955-1958", "1956-1968", "1957-1968", "1985-2007", "1985-2007", "1957-1984", "1958-1968", "1958-1984", "1959-1968", "1959-1964", "1959-1960", "1960-1968", "1960-2015", "1961-1968", "1971-1976", "1962-1968", "1962-1991", "1962-2015", "1962-1971", "1962-1971", "1962-1984", "1963-1963", "1963-1968", "1963-1989", "1963-1976", "1964-1968", "1963-1967", "1965-1976", "1965-1968", "1966-1968", "1967-1968", "1967-2015", "1967-2015", "1967-2004", "1967-2015", "1968-1978", "1968-2014", "1969-1971", "1969-1971", "1969-2004", "1976-1995", "1970-1989", "1970-1971", "1971-1971", "1976-2015", "1976-2015", "1976-2004", "1971-1995", "1981-2015", "1972-1987", "1972-1975", "1972-1992", "1984-2015", "1973-2015", "1973-1977", "1973-1974", "1974-2015", "1974-1998", "1974-1975", "1975-1998", "1989-2006", "1976-1976", "1976-1978", "1976-1977", "1976-1983", "1976-2015", "1976-1978", "1977-1987", "1977-1983", "1977-2015", "1977-1978", "1978-1982", "1978-1988", "1978-1991", "1978-1999", "1988-2006", "1978-2015", "1978-2015", "1979-2015", "1980-1988", "1980-2015", "1980-1983", "1981-2015", "1981-1995", "1982-2015", "1982-1988", "1983-1986", "1983-2015", "1983-1987", "1984-2015", "1984-1986", "1984-1992", "1983-2003", "1985-2014", "1985-1989", "1985-2015", "1985-1999", "1986-2015", "1985-1992", "1986-2015", "1986-2015", "1986-1995", "1986-2014", "1986-2014", "1986-1995", "1986-1999", "1987-1989", "1987-1998", "1987-1992", "1987-1987", "1988-1995", "1988-2015", "1988-2015", "1988-2015", "1988-2014", "1989-2007", "1988-1990", "1989-2015", "1989-1991", "1989-2015", "1989-2007", "1989-2015", "1989-2014", "1989-1999", "1990-2002", "1990-1990", "1991-2015", "1991-2015", "1991-2006", "1991-2003", "1991-2008", "1991-1995", "1992-1997", "1992-2015", "1992-2001", "1992-2002", "1992-1998", "1992-2015", "1992-2015", "1995-2015", "1992-1998", "1993-1993", "1993-1999", "1993-2003", "1993-2002", "1993-1996", "1994-2015", "1994-1994", "1994-2015", "1994-1994", "1994-2015", "1994-2006", "1994-2002", "1995-2006", "1995-2003", "1995-2015", "1995-2015", "1995-2006", "1995-2015", "1995-1998", "1995-2015", "1996-2015", "1996-2015", "1996-2000", "1996-1998", "1996-2006", "1997-2015", "1997-2004", "2004-2015", "1997-2001", "1997-2001", "1998-2011", "1998-2001", "1998-2003", "1998-2015", "1998-2015", "1999-2005", "1999-2015", "1999-2005", "1999-2008", "2000-2000", "2000-2015", "2000-2015", "2000-2004", "2000-2008", "2001-2010", "2001-2007", "2001-2006", "2001-2015", "2002-2005", "2002-2012", "2002-2015", "2002-2015", "2002-2012", "2002-2002", "2002-2015", "2002-2006", "2002-2015", "2002-2002", "2002-2002", "2002-2015", "2002-2002", "2002-2002", "2003-2003", "2003-2003", "2003-2015", "2003-2003", "2003-2003", "2003-2009", "2007-2015", "2003-2015", "2003-2015", "2004-2004", "2004-2015", "2004-2012", "2004-2015", "2004-2005", "2004-2008", "2004-2004", "2004-2010", "2005-2005", "2005-2010", "2005-2008", "2005-2014", "2005-2010", "2006-2015", "2006-2013", "2006-2007", "2006-2015", "2006-2015", "2006-2015", "2007-2015", "2007-2011", "2007-2015", "2007-2015", "2007-2015", "2007-2015", "2007-2015", "2008-2015", "2008-2012", "2008-2010", "2008-2015", "2008-2015", "2008-2015", "2008-2008", "2008-2015", "2008-2015", "2008-2015", "2008-2012", "2008-2015", "2008-2015", "2009-2009", "2009-2015", "2009-2015", "2009-2015", "2009-2015", "2009-2012", "2009-2015", "2009-2015", "2009-2015", "2010-2010", "2010-2012", "2010-2015", "2010-2015", "2010-2015", "2010-2015", "2011-2015", "2011-2015", "2011-2015", "2011-2015", "2011-2015", "2011-2015", "2011-2015", "2012-2015", "2012-2015", "2012-2015", "2012-2015", "2012-2012", "2012-2015", "2012-2015", "2012-2012", "2012-2015", "2012-2015", "2012-2015", "2013-2015", "2013-2015", "2013-2015", "2013-2015", "2013-2015", "2013-2015", "2013-2025", "2013-2015", "2014-2015", "2014-2014", "2014-2015", "2014-2015", "2014-2015", "2014-2015", "2014-2015", "2014-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015", "2015-2015"]

    var h = 500;
    var w = 500;
    var pad = 1;
    var lineStart = 1850
    var lineEnd = 2020
    var lineScale = 2;
    var margin = 20;

    var svg = d3.select('#timeline')
        .append('svg')
        .attr('height', h)
        .attr('width', w)

    var xscale = d3.scale.linear()
        .domain([lineStart, lineEnd])
        .range([0, w])
        // console.log(scale(1885))
        // console.log(scale(1950))
        // console.log(scale(2015))

    svg.selectAll('rect')
        .data(lawDates)
        .enter()
        .append('rect')
        .attr('x', function(d, i) {
            var from = parseInt(lawDates[i].Validity.substring(0, 4));
            return xscale(from);
        })
        .attr('y', function(d, i) {
            return (i + margin) * (h - margin) / (lawDates.length);
        })
        .attr('width', function(d, i) {
            from = parseInt(lawDates[i].Validity.substring(0, 4));
            to = parseInt(lawDates[i].Validity.substring(5, 9));
            return xscale(to - from + lineStart);
        })
        .attr('height', h / lawDates.length - pad);

    var xaxis = d3.svg.axis()
        .scale(xscale)
        .orient('top');

    svg.append('g')
        .attr('class', 'axis')
        .attr('transform', 'translate(0,20)')
        .call(xaxis);

}

function buildVenn() {
    var width = 300,
        height = 300;
    length = 400

    var svg = d3.select("#venn").append("svg")
        .attr("width", length)
        .attr("height", length);

    svg.append("circle")
        .attr("cx", length / 3)
        .attr("cy", length / 3)
        .attr("r", length / 3)
        .style("fill", "brown")
        .style("fill-opacity", ".5");

    svg.append("circle")
        .attr("cx", length / 3)
        .attr("cy", 2 * length / 3)
        .attr("r", length / 3)
        .style("fill", "steelblue")
        .style("fill-opacity", ".5");

    svg.append("circle")
        .attr("cx", 2 * length / 3)
        .attr("cy", length / 3)
        .attr("r", length / 3)
        .style("fill", "green")
        .style("fill-opacity", ".5");

    svg.append("circle")
        .attr("cx", 2 * length / 3)
        .attr("cy", 2 * length / 3)
        .attr("r", length / 3)
        .style("fill", "purple")
        .style("fill-opacity", ".5");

    svg.append("text")
        .attr('x', length / 6)
        .attr('y', length / 6)
        .text('Francoism')

    svg.append("text")
        .attr('x', length / 6)
        .attr('y', 5 * length / 6)
        .text('Constituition')

    svg.append("text")
        .attr('x', 4 * length / 6)
        .attr('y', length / 6)
        .text('Crisis')

    svg.append("text")
        .attr('x', 4 * length / 6)
        .attr('y', 5 * length / 6)
        .text('European Union')

    svg.append("text")
        .attr('x', length / 4)
        .attr('y', length / 2)
        .text('28')

    svg.append("text")
        .attr('x', length / 2)
        .attr('y', length / 4)
        .text('28')

    svg.append("text")
        .attr('x', 3 * length / 4)
        .attr('y', length / 2)
        .text('28')

    svg.append("text")
        .attr('x', length / 2)
        .attr('y', 3 * length / 4)
        .text('28')

    svg.append("text")
        .attr('x', 5 * length / 12)
        .attr('y', 5 * length / 12)
        .text('28')

    svg.append("text")
        .attr('x', 7 * length / 12)
        .attr('y', 5 * length / 12)
        .text('28')

    svg.append("text")
        .attr('x', 5 * length / 12)
        .attr('y', 7 * length / 12)
        .text('28')

    svg.append("text")
        .attr('x', 7 * length / 12)
        .attr('y', 7 * length / 12)
        .text('28')
}